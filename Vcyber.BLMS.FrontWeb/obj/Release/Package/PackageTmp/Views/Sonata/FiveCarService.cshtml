@{
    Layout = "~/Views/Shared/_LayoutPageHome.cshtml";
    ViewBag.Title = "5种车辆养护产品";
    var carlist = (List<Vcyber.BLMS.Entity.MaintainService>)ViewBag.carlist;
}
<style>
    .fuwuTable {
        width: 80%;
        margin: 10px auto;
        border: 1px solid #CCC;
        color: #333;
    }

        .fuwuTable tr th {
            background: #eee;
            padding: 10px 3px;
            border: 1px solid #CCC;
        }

        .fuwuTable tr td {
            padding: 10px 3px;
            border: 1px solid #CCC;
            text-align: center;
            width: 50%;
        }

         
         .pro_exchange {
                            margin-top: 40px;
                        }

                        .exchange_box {
                            margin-left: 22px;
                            height: 470px;
                        }

                            .exchange_box li {
                                margin-right: 44px;
                                margin-top: 25px;
                                border: 1px solid #e5e5e5;
                                float: left;
                                width: 178px;
                                height: 218px;
                            }
                                .exchange_box li:nth-child(3n){
                                    margin-right: 0px;

                                }

                                .exchange_box li img {
                                    margin: 10px auto;
                                    display: block;
                                    height:111px;
                                }

                                .exchange_box li p {
                                    text-align: center;
                                    color: #333333;
                                    font-size: 14px;
                                    text-indent: 0px;
                                }

                        a.btnXbkBg2 {
                            display: block;
                            width: 140px;
                            font-size: 14px;
                            height: 30px;
                            margin: 20px auto 0 auto;
                            background: #004587;
                            line-height: 30px;
                            text-align: center;
                            color: #fff;
                        }

                            a.btnXbkBg2:hover {
                                background: #0b63b7;
                            }
                            .bluePopup .layui-layer-btn{margin-top:-50px;}
   
</style>
<div>
    <div class="header">
        @Html.Action("HomeHeader", "Header", new { pageName = "Sonata" })
    </div>
    <div class="n_all_cont" style="height:1200px;">
        <div class="n_left_cont">
            <div class="center logon" style=" width: 286px; height: auto; margin-top:0;">
                @{
                    if (this.User.Identity.IsAuthenticated)
                    {
                        @Html.Action("HomeLogonSuccess", "Account")
                    }
                    else
                    {
                        @Html.Action("HomeLogon", "Account")
                    }
                }
            </div>
            <div class="homereserve">
                @Html.Action("ReserveRegion", "Home")
            </div>
            <div class="homeShortcut">
                @Html.Action("ShortcutRegion", "Home")
            </div>
            <div class="homeproduct">
                @Html.Action("HotExchangeProductList", "Product")
            </div>
            <div class="homehotnews">
                @Html.Action("HotNewsRegion", "home")
            </div>
        </div>
        <div class="n_right_cont">
            <div class="new_menu">
                <p class="select_menu">  <a href="/BlueVIP/Index">蓝缤权益</a> ><a href="/CarService/Index">车辆服务</a> >5种车辆养护产品</p>
            </div>
            <div class="gy_cont" style="margin-top:0;">
                <div class="gy_title">
                    <div class="gy_zi">
                        <h1>5种车辆养护产品</h1>
                        <span>Five Vehicle Maintenance Products</span>
                    </div>
                </div>
                <div class="fwxq_box" >
                    <p>2016年4月1日之后购车并注册成为bluemembers银卡会员可在5种车辆养护产品中任选1种（1次/年）</p>
                    <p>2016年4月1日之后购车并注册成为bluemembers金卡会员可在5种车辆养护产品中任选1种（2次/年）</p>
                    <p><strong style="font-weight:900;">服务对象：</strong>bluemembers银卡会员、bluemembers金卡会员</p>
                    <p style="font-weight:900">
                        服务说明：
                    </p>
                    <table class="fuwuTable">
                        <thead>
                            <tr>
                                <th>5种车辆养护产品</th>
                                <th>建议使用车龄</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>车辆维新组合</td>
                                <td>1-2年</td>
                            </tr>
                            <tr>
                                <td>空调杀菌消毒剂</td>
                                <td>2-3年</td>
                            </tr>
                            <tr>
                                <td>发动机线路保护剂</td>
                                <td>3-4年</td>
                            </tr>
                            <tr>
                                <td>燃油添加剂（普通）</td>
                                <td>所有车龄</td>
                            </tr>
                            <tr>
                                <td>空气滤芯</td>
                                <td>所有车龄</td>
                            </tr>
                        </tbody>
                    </table>


                    <p style="font-weight:900">
                        客户流程：
                    </p>
                    @*<p>登录会员中心——选择车辆养护产品——获取卡券——经销商店内使用卡券——车辆养护服务</p>*@
                    <p><img  src="~/Img/VipImg/FiveCarFlow.png"/></p>

                    <!--添加领取商品-->
                    <div class="pro_exchange">
                        <p style="font-weight:900">
                            养护产品领取：
                        </p>
                        <ul class="exchange_box">
                            @foreach (var item in carlist)
                            {
                                <li>
                                    <img src="@item.CardLogoUrl" alt="@item.CardName" id='@("cardname" + item.CradId)' title="@item.CardName">
                                    <p>@item.CardName</p>
                                    <input type="hidden" value="@item.CardType" id='@("cardType" + item.CradId)'>
                                    <a href="javascript:void(0)" id="@item.CradId" class="btnXbkBg2" style="font-family:'微软雅黑';">立即领取</a>
                                </li>
                            }
                        </ul>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(".btnXbkBg2").click(function () {
        var id = $(this).attr("id");
        var cardType = $("#cardType" + id).val();
        $.ajax({
            url: "/sonata/checkCard",
            dataType: "json",
            type: "post",
            data: {cardType:cardType},
            success: function (data) {
                if (data.msg == "success") {
                    $.ajax({
                        url: "/Order/postAddUserCustomCard",
                        dataType: "json",
                        type: "post",
                        data: { cardName: cardType },
                        success: function (result) {
                            if (result.msg == "success") {
                                var date = new Date();
                                var endDate = new Date(new Date().setDate(date.getDate() + 60));
                                var cardName = $("#cardname" + id).attr("alt");
                                var expiryTime = date.getFullYear() + "年" + (date.getMonth() + 1) + "月" + date.getDate() + "日至" + endDate.getFullYear() + "年" + (endDate.getMonth() + 1) + "月" + endDate.getDate() + "日";
                                layer.open({
                                    type: 1,
                                    skin: 'bluePopup', //样式类名
                                    closeBtn: 1, //不显示关闭按钮
                                    area: ["440px", "210px"],
                                    shift: 2,
                                    content: "尊敬的会员您好，您已领取" + cardName + "卡券，卡券有效期" + expiryTime + "，请尽快使用！详情登录bluemembers个人中心查看。",
                                    end: function () {
                                    },
                                    btn: ['确定']
                                });
                            } else {
                                layer.open({
                                    type: 1,
                                    skin: 'bluePopup', //样式类名
                                    closeBtn: 1, //不显示关闭按钮
                                    area: ["410px", "210px"],
                                    shift: 2,
                                    content: "尊敬的会员您好，未在卡券的领取有效期内，请联系管理员！",
                                    end: function () {
                                        window.location.href = "/";
                                    },
                                    btn: ['确定']
                                });
                            }
                        }
                    });
                } else {
                    layer.open({
                        type: 1,
                        skin: 'bluePopup', //样式类名
                        closeBtn: 1, //不显示关闭按钮
                        area: ["410px", "210px"],
                        shift: 2,
                        content: data.msg,
                        end: function () {
                            window.location.href = "/";
                        },
                        btn: ['确定']
                    });
                }
            }
            });
    });
</script>

<div class="footer">
    @Html.Action("Index", "Footer")
</div>